<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EVOKA - Tu Legado Digital</title>

  <script src="https://cdn.tailwindcss.com"></script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">

  <style>
    body { font-family: 'Nunito', sans-serif; }
    .fade-in { animation: fadeIn 0.5s ease-in-out; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    #nav-rail { transition: width 0.3s ease-in-out; }
    #nav-rail .nav-text {
      transition: opacity 0.2s ease-in-out;
      opacity: 0; width: 0; overflow: hidden; white-space: nowrap;
    }
    #nav-rail:hover .nav-text { opacity: 1; width: auto; margin-left: 1rem; }

    .modal-backdrop { background: rgba(0,0,0,0.6); }
  </style>

</head>

<body class="bg-[#131314] text-gray-200 antialiased flex">

  <!-- APP:ROOT -->

  <!-- Barra de Navegación Lateral -->
  <aside id="nav-rail" class="bg-[#1e1f20] h-screen p-4 flex flex-col items-center space-y-6 w-20 hover:w-64 transition-all duration-300 ease-in-out group">
    <div class="w-16 mb-4">
      <svg viewBox="0 0 250 80" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="gradIso1" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" style="stop-color:#22d3ee;stop-opacity:1" />
            <stop offset="100%" style="stop-color:#06b6d4;stop-opacity:1" />
          </linearGradient>
        </defs>
        <text x="50%" y="50%" dy=".3em" text-anchor="middle" font-family="Nunito, sans-serif" font-size="50" font-weight="800" fill="url(#gradIso1)" letter-spacing="-2">
          EV<tspan fill="#67e8f9">O</tspan>KA
        </text>
        <path d="M 68 40 L 182 40" stroke="url(#gradIso1)" stroke-width="3" stroke-linecap="round"/>
      </svg>
    </div>

    <nav id="side-nav" class="flex flex-col space-y-2 w-full"></nav>
  </aside>

  <!-- CONTENEDOR PRINCIPAL -->
  <div class="flex-1 flex flex-col h-screen">

    <!-- Header -->
    <header class="flex justify-end items-center py-4 px-6">
      <div class="relative">
        <button id="profile-button" onclick="window.app.toggleProfileMenu()"
          class="flex items-center space-x-2 bg-gray-800/50 p-1 pr-3 rounded-full transition hover:bg-gray-700">
          <div class="w-8 h-8 bg-gray-700 rounded-full flex items-center justify-center font-bold text-cyan-300 border-2 border-cyan-500">F</div>
          <div class="flex flex-col items-start -space-y-1">
            <span id="user-status" class="text-xs font-bold text-cyan-400">FREE</span>
            <div class="flex items-center gap-1 text-xs text-gray-300">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
              <svg width="28" height="28" viewBox="0 0 24 24" fill="none" aria-hidden="true">
  <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="1.6" opacity="0.9"></circle>
  <path d="M8 16.2c1-1.6 2.4-2.4 4-2.4s3 0.8 4 2.4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></path>
  <path d="M12 12.2c1.3 0 2.4-1.1 2.4-2.4S13.3 7.4 12 7.4 9.6 8.5 9.6 9.8s1.1 2.4 2.4 2.4z"
        stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path>
</svg>

              </svg>
              <span id="token-count">1</span>
            </div>
          </div>
        </button>

        <div id="profile-menu" class="hidden absolute right-0 mt-2 w-56 origin-top-right bg-[#2c2d2f] rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-20">
          <div class="py-1" role="menu">
            <a href="#" onclick="window.app.navigateTo('profile')" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700">Perfil</a>
            <a href="#" onclick="window.app.navigateTo('settings')" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700">Configuración</a>
            <div class="border-t border-gray-700 my-1"></div>
            <a href="#" onclick="window.app.navigateTo('plans')" class="block px-4 py-2 text-sm font-semibold text-cyan-400 hover:bg-gray-700">Mejora tu experiencia</a>
          </div>
        </div>
      </div>
    </header>

    <!-- Contenido -->
    <main id="main-content" class="flex-grow flex flex-col px-6 pb-24 overflow-y-auto"></main>

    <!-- Action bar -->
    <footer id="action-bar" class="fixed bottom-0 left-20 right-0 p-4 max-w-[calc(32rem-5rem)] mx-auto"></footer>
  </div>

  <!-- Toast -->
  <div id="confirmation-message" class="hidden fixed bottom-24 left-1/2 -translate-x-1/2 bg-green-500 text-white py-2 px-6 rounded-full shadow-lg text-center z-40">
    Tu memoria ha sido publicada en tu legado.
  </div>

  <!-- Modal root -->
  <div id="modal-root" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop p-4"></div>

  <script>
    // ----------------------------
    // Global App Object + Data
    // ----------------------------
    window.app = {};

    let dailyTokens, executors, capsulesData, dialogueData, userData;
    let dedicatedIndex, claimsData;
    let tempCapsuleData = {};
    let isRecording = false;

    document.addEventListener('DOMContentLoaded', () => {
      app.loadDataFromLocalStorage();
      app.loadStaticUI();
      app.navigateTo('home');

      window.addEventListener('click', function(e) {
        const profileButton = document.getElementById('profile-button');
        const profileMenu = document.getElementById('profile-menu



